1. 函数名  
diagSetCurrentSession  

2. 函数描述  
设置诊断节点会话模式。  

3. 函数体  
```vba
diagSetCurrentSession(diagNode: DiagNode, sessionId: int, res_flag: bool = False, mode: int = 0)
```  

4. 返回值  
情况1：正确读值  
| 名称 | 类型 | 描述 |  
|------|------|------|  
| list | List | 正常PDU返回List类型 |  

情况2：异常情况  
| 名称 | 类型 | 描述 |  
|------|------|------|  
| res  | int  | 返回-1，代表诊断通道激活失败 |  
|      |      | 返回1，代表服务执行失败（其他情况） |  
|      |      | 返回2，代表服务发送失败 |  
|      |      | 返回3，代表服务响应超时 |  
|      |      | 返回4，代表响应PDU解析失败 |  

5. 参数  
| 名称      | 类型     | 描述 |  
|-----------|----------|------|  
| diagNode  | DiagNode | 诊断节点对象 |  
| sessionId | int      | 会话ID |  
| res_flag  | bool     | 可选，默认为False |  
| mode      | int      | 可选，默认为0 |  

6. 示例  
**功能**：设置诊断节点ACU的会话模式为默认会话10。  
**代码**：  
```vba
diagSetCurrentSession(CAN1.DiagNodes.ACU, 1, False, 0)
```  
**注释**：  
- `CAN1.DiagNodes.ACU`：指定诊断节点为ACU。  
- `1`：会话ID为1（默认会话）。  
- `False`：不启用特殊标志。  
- `0`：模式为默认值0。  

7. 其他说明  
- 该函数用于配置诊断节点的会话模式，适用于CAN或其他总线诊断场景。  
- 返回值包含多种状态，需根据实际情况处理异常情况。